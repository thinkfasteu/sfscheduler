<!DOCTYPE html>
<html>
<head>
    <title>Clear App Cache & State</title>
    <style>
        body { font-family: system-ui; padding: 20px; max-width: 600px; margin: 0 auto; }
        .btn { padding: 10px 20px; margin: 10px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .btn:hover { background: #c82333; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>üßπ Clear Application State</h1>
    <p>This will clear all cached data, localStorage, and force a fresh start.</p>
    
    <button class="btn" onclick="clearAllData()">Clear All App Data</button>
    <button class="btn" onclick="clearJustSchedule()">Clear Just Schedule Data</button>
    <button class="btn" onclick="clearJustAvailability()">Clear Just Availability Data</button>
    
    <div id="status"></div>
    
    <h2>Manual Steps:</h2>
    <ol>
        <li><strong>Hard Refresh:</strong> Ctrl+Shift+R (or Cmd+Shift+R on Mac)</li>
        <li><strong>Clear Browser Cache:</strong> F12 ‚Üí Application ‚Üí Storage ‚Üí Clear Site Data</li>
        <li><strong>Disable Cache:</strong> F12 ‚Üí Network ‚Üí Check "Disable cache"</li>
    </ol>

    <script>
        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function clearAllData() {
            try {
                // Clear localStorage
                localStorage.clear();
                
                // Clear sessionStorage
                sessionStorage.clear();
                
                // Clear IndexedDB if any
                if ('indexedDB' in window) {
                    indexedDB.databases().then(dbs => {
                        dbs.forEach(db => {
                            indexedDB.deleteDatabase(db.name);
                        });
                    });
                }
                
                showStatus('‚úÖ All application data cleared! Please hard refresh (Ctrl+Shift+R) the main app.', 'success');
            } catch (e) {
                showStatus('‚ùå Error clearing data: ' + e.message, 'error');
            }
        }

        function clearJustSchedule() {
            try {
                // Look for schedule-related keys
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.includes('schedule') || key.includes('Schedule'))) {
                        keysToRemove.push(key);
                    }
                }
                
                keysToRemove.forEach(key => localStorage.removeItem(key));
                
                showStatus(`‚úÖ Cleared ${keysToRemove.length} schedule-related items: ${keysToRemove.join(', ')}`, 'success');
            } catch (e) {
                showStatus('‚ùå Error: ' + e.message, 'error');
            }
        }

        function clearJustAvailability() {
            try {
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.includes('availability') || key.includes('Availability'))) {
                        keysToRemove.push(key);
                    }
                }
                
                keysToRemove.forEach(key => localStorage.removeItem(key));
                
                showStatus(`‚úÖ Cleared ${keysToRemove.length} availability-related items: ${keysToRemove.join(', ')}`, 'success');
            } catch (e) {
                showStatus('‚ùå Error: ' + e.message, 'error');
            }
        }

        // Show current localStorage contents
        function showCurrentData() {
            const keys = Object.keys(localStorage);
            if (keys.length === 0) {
                showStatus('No data in localStorage', 'info');
            } else {
                showStatus(`Current localStorage keys: ${keys.join(', ')}`, 'info');
            }
        }

        // Show on load
        showCurrentData();
    </script>
</body>
</html>